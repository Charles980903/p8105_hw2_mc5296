---
title: "Hw2"
output: github_document
date: "2022-09-30"
---

# Problem 1 

## import data

```{r}
library(tidyverse)
raw_data = read.csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")
head(raw_data)
```
## clean data
```{r}
raw_data$Route8 <- as.character(raw_data$Route8)
raw_data$Route9 <- as.character(raw_data$Route9)
raw_data$Route10 <- as.character(raw_data$Route10)
raw_data$Route11<- as.character(raw_data$Route11)
summary(raw_data)
data = raw_data%>%
  janitor::clean_names() %>% 
  select(line:entry,vending,ada) %>%
  mutate(
    entry = recode(entry, "YES" = 1, "NO" = 0),
    entry = factor(entry)
    )
  
summary(data)
```
The original dataset is a 1868 * 32 dataset. It contains 
1)The name and location of the station of the entrances
2)the route that stop at the stations
3)the stations' entrance type
4)whether it is a entry or exit only
5)whether there is a vending machine
6)the staffing condition 
7)Whether there is free corssover
8)location of the entrance 
The first step is to convert the type of route8-route11 to character.
And I used clean_names() to clean up the column names. Then I selected the required columns and convert the entry variable to logical value. 
The results is a 1868 * 19 dataset

## How many distinct stations are there?
```{r}
data %>%
  select(line, station_name)%>%
  distinct()%>%
  nrow()
```
Answer: there are 465 distinct stations
## How many stations are ADA compliant?
```{r}
data %>%
  filter(ada == TRUE) %>%
  distinct()%>%
  nrow()

```
Answer: 179 stations are ADA compliant.

## What proportion of station entrances / exits without vending allow entrance?
```{r}
data %>%
  filter(vending == "NO")%>%
  nrow()
```
```{r}
183/1868 *100
```
Answer: 9.79% of the entrances/exits without vending machine allow entrance

## reformat the table to make route number and route name  distinct variables
```{r}
reformed_data <- data %>%
  pivot_longer(route1:route11,
               names_to = "route_number",
               values_to = "route_name") # reformat the data
reformed_data %>% 
  select(line,station_name,route_name)%>%
  filter(route_name == "A")%>%
  distinct()%>%
  nrow()  # stations that serve A train
reformed_data %>%
  select(line,station_name,route_name,ada)%>%
  filter(route_name == "A")%>%
  filter(ada == TRUE)%>%
  distinct()%>%
  nrow() # total number of ADA compliant stations

```
Answer: 60 distinct stations serve A train, 17 has ADA Compliant.


# Problem 2
## import data
```{r}
library(readxl)
raw_data2 <- read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                        sheet = "Mr. Trash Wheel")
head(raw_data2)
```
## clean data
```{r}
data <- raw_data2 %>%
  janitor::clean_names()%>%
  select(1:14)%>% # remove useless columns
  na.omit()%>%  # remove non dumpster-specific rows
  rename("Dumpster number" = dumpster, 
         "Weight(tons)" = weight_tons,
         "Volume(cubic yards)" = volume_cubic_yards) 
data$sports_balls <- round (data$sports_balls, 0) # round the variable to the nearest integer.
data$sports_balls <- as.integer(data$sports_balls) # round the number of sports balls to the nearest integer and convert the type to integer. 
head(data)
```
## import Professor Trash Wheel data

```{r}
raw_data3 <- read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                        sheet = "Professor Trash Wheel")
raw_data3
```
## clean data
```{r}
data2 <- raw_data3 %>%
  janitor::clean_names()%>%
  select(1:14)%>% # remove useless columns
  na.omit()%>%  # remove non dumpster-specific rows
  rename("Dumpster number" = dumpster, 
         "Weight(tons)" = weight_tons,
         "Volume(cubic yards)" = volume_cubic_yards) 
data2$'Dumpster number'<- as.character(data2$'Dumpster number')
data2$sports_balls <- round (data2$sports_balls, 0) # round the variable to the nearest integer.
data2$sports_balls <- as.integer(data2$sports_balls) # round the number of sports balls to the nearest integer and convert the type to integer. 
data2
```

## combine the dataset
```{r}
data$trash_wheel_type <- "My Trash Wheel"
data2$trash_wheel_type <- "Professor Trash Wheel" # add new column
new_data <- full_join(data,data2) # combine two datasets
summary(new_data)
```

Both the datasets contain the date of the transport time, weight, volume and amount of each type of trash the dumpster transported. The datasets also include the amount of homes which powered by  electricity generated by the trash. For example, they the column "Weight", "Volume" provides the weight and volume of trash each dumpster transported each day."Plastic_bottles", "polystyrene" represents the amount of  part of the types of the trash disposed by dumpster.

## Information in the data
```{r}
sum(data2$`Weight(tons)`)
```
Answer: The total weight of trash collected by Professor Trash Wheel is 135.5 tons
```{r}
filtered_data <- data %>%
  select(sports_balls, year)%>%
  filter(year == 2020)  #create a table store the amount of sports balls collected in each day in 2020.

sum(filtered_data$sports_balls)
```
Answer: Number of sports balls collected by Mr. Trash Wheel in 2020 is 856.